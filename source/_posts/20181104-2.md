---
title: å¹¶å‘æ“ä½œåˆé›†-9.å¹¶å‘å·¥å…·ï¼šSemaphore,CountDownLatch,CyclicBarrier
typora-copy-images-to: 20181104-2
date: 2018-11-04 12:57:07
tags:
  - Java
  - å¹¶å‘
  - å¹¶å‘æ“ä½œåˆé›†
categories:
  - å¹¶å‘æ“ä½œåˆé›†
---

> ğŸ¤ [å¹¶å‘æ“ä½œåˆé›†ç³»åˆ— ç›®å½•]()
>
> ğŸ• [å¹¶å‘æ“ä½œåˆé›†ç³»åˆ— æºä»£ç ](https://github.com/nnkwrik/learn-java-concurrency)

è¿™ç¯‡æ–‡ç« ä¼šä»‹ç»3ä¸­éå¸¸å®ç”¨çš„å¹¶å‘å·¥å…·ï¼ŒSemaphoreï¼ŒCountDownLatchï¼ŒCyclicBarrierã€‚

# Semaphore

Semaphoreå¯ä»¥ç†è§£ä¸º**ä¿¡å·é‡**ï¼Œç”¨äºæ§åˆ¶èµ„æºèƒ½å¤Ÿè¢«å¹¶å‘è®¿é—®çš„çº¿ç¨‹æ•°é‡ï¼Œä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹èƒ½å¤Ÿåˆç†çš„ä½¿ç”¨ç‰¹å®šèµ„æºã€‚Semaphoreå°±ç›¸å½“äºä¸€ä¸ªè®¸å¯è¯ï¼Œçº¿ç¨‹éœ€è¦å…ˆé€šè¿‡acquireæ–¹æ³•è·å–è¯¥è®¸å¯è¯ï¼Œè¯¥çº¿ç¨‹æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¦åˆ™åªèƒ½åœ¨è¯¥æ–¹æ³•å‡ºé˜»å¡ç­‰å¾…ã€‚å½“æ‰§è¡Œå®Œä¸šåŠ¡åŠŸèƒ½åï¼Œéœ€è¦é€šè¿‡`release()`æ–¹æ³•å°†è®¸å¯è¯å½’è¿˜ï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿè·å¾—è®¸å¯è¯ç»§ç»­æ‰§è¡Œã€‚

Semaphoreå¯ä»¥ç”¨äºåšæµé‡æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯å…¬å…±èµ„æºæœ‰é™çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥ã€‚å‡å¦‚æœ‰å¤šä¸ªçº¿ç¨‹è¯»å–æ•°æ®åï¼Œéœ€è¦å°†æ•°æ®ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œå¯ç”¨çš„æœ€å¤§æ•°æ®åº“è¿æ¥åªæœ‰3ä¸ªï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨Semaphoreæ¥æ§åˆ¶èƒ½å¤Ÿå¹¶å‘è®¿é—®åˆ°æ•°æ®åº“è¿æ¥èµ„æºçš„çº¿ç¨‹ä¸ªæ•°æœ€å¤šåªæœ‰3ä¸ªã€‚åœ¨é™åˆ¶èµ„æºä½¿ç”¨çš„åº”ç”¨åœºæ™¯ä¸‹ï¼ŒSemaphoreæ˜¯ç‰¹åˆ«åˆé€‚çš„ã€‚

ä¸‹é¢æ¥çœ‹ä¸‹Semaphoreçš„ä¸»è¦æ–¹æ³•ï¼š

- acquire() ï¼š è·å–è®¸å¯ï¼Œå¦‚æœæ— æ³•è·å–åˆ°ï¼Œåˆ™é˜»å¡ç­‰å¾…ç›´è‡³èƒ½å¤Ÿè·å–ä¸ºæ­¢

- tryAcquire()ï¼š è·å–è®¸å¯ï¼Œå¦‚æœè®¸å¯ç«‹å³å¯ç”¨åˆ™è¿”å›trueå¹¶è·å–å¦åˆ™è¿”å›false
- release() ï¼š é‡Šæ”¾è®¸å¯
- availablePermits() : è¿”å›å½“å‰å¯ç”¨çš„è®¸å¯è¯ä¸ªæ•°
- hasQueuedThreads() : æ˜¯å¦æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–è®¸å¯è¯
- getQueuedThreads() : è·å–æ‰€æœ‰æ­£åœ¨ç­‰å¾…è®¸å¯çš„çº¿ç¨‹é›†åˆ

å¦å¤–ï¼Œåœ¨Semaphoreçš„æ„é€ æ–¹æ³•ä¸­è¿˜æ”¯æŒæŒ‡å®šæ˜¯å¤Ÿå…·æœ‰å…¬å¹³æ€§ï¼Œé»˜è®¤çš„æ˜¯éå…¬å¹³æ€§ï¼Œè¿™æ ·ä¹Ÿæ˜¯ä¸ºäº†ä¿è¯ååé‡ã€‚

## ç¤ºä¾‹ç¨‹åº

çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š

```java
Runnable runnable = () -> {
    try {
        semaphore.acquire();
        System.out.println(Thread.currentThread().getName() + " =====> è·å–è®¸å¯");
        System.out.println(Thread.currentThread().getName() + "        æ‰§è¡Œä¸­");
        TimeUnit.SECONDS.sleep(3);
        System.out.println(Thread.currentThread().getName() + " <===== é‡Šæ”¾è®¸å¯");
        semaphore.release();
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

};
for (int i = 0; i < 5; i++) {
    new Thread(runnable).start();
}
--------------------------------
è¾“å‡º
Thread-0 =====> è·å–è®¸å¯
Thread-0        æ‰§è¡Œä¸­
Thread-1 =====> è·å–è®¸å¯
Thread-1        æ‰§è¡Œä¸­
Thread-2 =====> è·å–è®¸å¯
Thread-2        æ‰§è¡Œä¸­
Thread-0 <===== é‡Šæ”¾è®¸å¯
Thread-2 <===== é‡Šæ”¾è®¸å¯
Thread-1 <===== é‡Šæ”¾è®¸å¯
Thread-3 =====> è·å–è®¸å¯
Thread-3        æ‰§è¡Œä¸­
Thread-4 =====> è·å–è®¸å¯
Thread-4        æ‰§è¡Œä¸­
Thread-3 <===== é‡Šæ”¾è®¸å¯
Thread-4 <===== é‡Šæ”¾è®¸å¯
```

ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œåªèƒ½åŒæ—¶è¿è¡Œ3ä¸ªçº¿ç¨‹ï¼Œå…¶ä»–çš„ä¸¤ä¸ªçº¿ç¨‹è¢«é˜»å¡ç›´åˆ°è®¸å¯è¢«å…¶ä»–çº¿ç¨‹é‡Šæ”¾ã€‚

# CountDownLatch

åœ¨å¤šçº¿ç¨‹åä½œå®Œæˆä¸šåŠ¡åŠŸèƒ½æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦ç­‰å¾…å…¶ä»–å¤šä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡ä¹‹åï¼Œä¸»çº¿ç¨‹æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œä¸šåŠ¡åŠŸèƒ½ï¼Œåœ¨è¿™ç§çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨Threadç±»çš„joinæ–¹æ³•ï¼Œè®©ä¸»çº¿ç¨‹ç­‰å¾…è¢«joinçš„çº¿ç¨‹æ‰§è¡Œå®Œä¹‹åï¼Œä¸»çº¿ç¨‹æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚å½“ç„¶ï¼Œä½¿ç”¨çº¿ç¨‹é—´æ¶ˆæ¯é€šä¿¡æœºåˆ¶ä¹Ÿå¯ä»¥å®Œæˆã€‚å…¶å®ï¼Œjavaå¹¶å‘å·¥å…·ç±»ä¸­ä¸ºæˆ‘ä»¬æä¾›äº†ç±»ä¼¼â€œå€’è®¡æ—¶â€è¿™æ ·çš„å·¥å…·ç±»ï¼Œå¯ä»¥ååˆ†æ–¹ä¾¿çš„å®Œæˆæ‰€è¯´çš„è¿™ç§ä¸šåŠ¡åœºæ™¯ã€‚

ä¸‹é¢æ¥çœ‹ä¸‹CountDownLatchçš„ä¸»è¦æ–¹æ³•ï¼š

- await() throws InterruptedExceptionï¼šè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹ç­‰åˆ°æ„é€ æ–¹æ³•ä¼ å…¥çš„Nå‡åˆ°0çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›
- await(long timeout, TimeUnit unit)ï¼šä¸ä¸Šé¢çš„awaitæ–¹æ³•åŠŸèƒ½ä¸€è‡´ï¼Œåªä¸è¿‡è¿™é‡Œæœ‰äº†æ—¶é—´é™åˆ¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹ç­‰åˆ°æŒ‡å®šçš„timeoutæ—¶é—´åï¼Œä¸ç®¡Næ˜¯å¦å‡è‡³ä¸º0ï¼Œéƒ½ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›
- countDown()ï¼šä½¿CountDownLatchåˆå§‹å€¼Nå‡1ï¼›
- long getCount()ï¼šè·å–å½“å‰CountDownLatchç»´æŠ¤çš„å€¼ï¼›

## ç¤ºä¾‹ç¨‹åº

çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š

```java
public static final int THREAD_NUM = 3;
private static CountDownLatch startSignal = new CountDownLatch(1);
private static CountDownLatch endSignal = new CountDownLatch(THREAD_NUM);   //å¡«å…¥è¦è¿›è¡Œå€’è®¡æ—¶çš„çº¿ç¨‹çš„æ•°é‡

public static void main(String[] args) throws InterruptedException {
    Runnable runnable = () -> {
        try {
            System.out.println(Thread.currentThread().getName() + "ç­‰å¾…å¼€å§‹");
            startSignal.await();    //ç›´åˆ°startSignalå˜æˆ0åæ‰ç»§ç»­æ‰§è¡Œ
            System.out.println(Thread.currentThread().getName() + "å¼€å§‹äº†");
            //ç­‰å¾…1~5ç§’
            Thread.sleep(ThreadLocalRandom.current().nextInt(1000,5000));
            System.out.println(Thread.currentThread().getName() + "ç»“æŸäº†");
            endSignal.countDown();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    };

    for (int i = 0; i < THREAD_NUM; i++) {
        new Thread(runnable).start();
    }

    Thread.sleep(1000);
    System.out.println("======> å¼€å§‹ï¼");
    startSignal.countDown();
    endSignal.await();
    System.out.println("======> ç»“æŸï¼");
}
---------------------------
è¾“å‡º
Thread-1ç­‰å¾…å¼€å§‹
Thread-0ç­‰å¾…å¼€å§‹
Thread-2ç­‰å¾…å¼€å§‹
======> å¼€å§‹ï¼
Thread-1å¼€å§‹äº†
Thread-0å¼€å§‹äº†
Thread-2å¼€å§‹äº†
Thread-2ç»“æŸäº†
Thread-1ç»“æŸäº†
Thread-0ç»“æŸäº†
======> ç»“æŸï¼
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“è°ƒç”¨CountDownLatchçš„countDownæ–¹æ³•æ—¶ï¼Œå½“å‰çº¿ç¨‹æ˜¯ä¸ä¼šè¢«é˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚

# CyclicBarrier


CyclicBarrierä¹Ÿæ˜¯ä¸€ç§å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶çš„å®ç”¨å·¥å…·ï¼Œå’ŒCountDownLatchä¸€æ ·å…·æœ‰ç­‰å¾…è®¡æ•°çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸æ¯”äºCountDownLatchåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚

ä¸ºäº†ç†è§£CyclicBarrierï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªé€šä¿—çš„ä¾‹å­ã€‚å¼€è¿åŠ¨ä¼šæ—¶ï¼Œä¼šæœ‰è·‘æ­¥è¿™ä¸€é¡¹è¿åŠ¨ï¼Œæˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸‹è¿åŠ¨å‘˜å…¥åœºæ—¶çš„æƒ…å†µï¼Œå‡è®¾æœ‰6æ¡è·‘é“ï¼Œåœ¨æ¯”èµ›å¼€å§‹æ—¶ï¼Œå°±éœ€è¦6ä¸ªè¿åŠ¨å‘˜åœ¨æ¯”èµ›å¼€å§‹çš„æ—¶å€™éƒ½ç«™åœ¨èµ·ç‚¹äº†ï¼Œè£åˆ¤å‘˜å¹å“¨åæ‰èƒ½å¼€å§‹è·‘æ­¥ã€‚è·‘é“èµ·ç‚¹å°±ç›¸å½“äºâ€œbarrierâ€ï¼Œæ˜¯ä¸´ç•Œç‚¹ï¼Œè€Œè¿™6ä¸ªè¿åŠ¨å‘˜å°±ç±»æ¯”æˆçº¿ç¨‹çš„è¯ï¼Œå°±æ˜¯è¿™6ä¸ªçº¿ç¨‹éƒ½å¿…é¡»åˆ°è¾¾æŒ‡å®šç‚¹äº†ï¼Œæ„å‘³ç€å‡‘é½äº†ä¸€æ³¢ï¼Œç„¶åæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™æ¯ä¸ªçº¿ç¨‹éƒ½å¾—é˜»å¡ç­‰å¾…ï¼Œç›´è‡³å‡‘é½ä¸€æ³¢å³å¯ã€‚cyclicæ˜¯å¾ªç¯çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯è¯´CyclicBarrierå½“å¤šä¸ªçº¿ç¨‹å‡‘é½äº†ä¸€æ³¢ä¹‹åï¼Œä»ç„¶æœ‰æ•ˆï¼Œå¯ä»¥ç»§ç»­å‡‘é½ä¸‹ä¸€æ³¢ã€‚CyclicBarrierçš„æ‰§è¡Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š

![img](20181104-2/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f323631353738392d356261636234663735373838326535362e6a70673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f353030.jpeg)

ä¸‹é¢æ¥çœ‹ä¸‹CyclicBarrierçš„ä¸»è¦æ–¹æ³•ï¼š

- await() ï¼š ç­‰åˆ°æ‰€æœ‰çš„çº¿ç¨‹éƒ½åˆ°è¾¾æŒ‡å®šçš„ä¸´ç•Œç‚¹
- await(long timeout, TimeUnit unit)  ï¼š è¿™é‡Œæœ‰è¶…æ—¶é™åˆ¶ï¼Œé˜»å¡ç­‰å¾…ç›´è‡³åˆ°è¾¾è¶…æ—¶æ—¶é—´ä¸ºæ­¢
- getNumberWaiting() : è·å–å½“å‰æœ‰å¤šå°‘ä¸ªçº¿ç¨‹é˜»å¡ç­‰å¾…åœ¨ä¸´ç•Œç‚¹ä¸Š
- isBroken() : æŸ¥è¯¢é˜»å¡ç­‰å¾…çš„çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­
- reset() : å°†å±éšœé‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚å¦‚æœå½“å‰æœ‰çº¿ç¨‹æ­£åœ¨ä¸´ç•Œç‚¹ç­‰å¾…çš„è¯ï¼Œå°†æŠ›å‡ºBrokenBarrierExceptionã€‚

å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCyclicBarrieræä¾›äº†è¿™æ ·çš„æ„é€ æ–¹æ³•ï¼š

```java
public CyclicBarrier(int parties, Runnable barrierAction)
```

å¯ä»¥ç”¨æ¥ï¼Œå½“æŒ‡å®šçš„çº¿ç¨‹éƒ½åˆ°è¾¾äº†æŒ‡å®šçš„ä¸´ç•Œç‚¹çš„æ—¶ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œçš„æ“ä½œå¯ä»¥ç”±barrierActionä¼ å…¥å³å¯ã€‚

## ç¤ºä¾‹ç¨‹åº

ç”¨CyclicBarrieræ”¹å†™ä¸Šé¢CountDownLatchçš„ç¤ºä¾‹ç¨‹åºï¼Œè¿™æ¬¡æˆ‘ä»¬è®©ä»–æ‰§è¡Œ2æ¬¡ï¼š

```java
public static final int THREAD_NUM = 3;
private static CyclicBarrier signal = new CyclicBarrier(THREAD_NUM,//å¡«å…¥è¦è¿›è¡Œå€’è®¡æ—¶çš„çº¿ç¨‹çš„æ•°é‡
                                                        () -> System.out.println("======> å¼€å§‹ï¼"));   //å½“æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾ä¸´ç•Œç‚¹æ—¶ä¼šæ‰§è¡Œè¿™æ¡Runnable

public static void main(String[] args) throws InterruptedException {
    Runnable runnable = () -> {
        int num = 2;

        try {
            while (num-- > 0) { //æ‰§è¡Œnumæ¬¡
                System.out.println(Thread.currentThread().getName() + "ç­‰å¾…å¼€å§‹");
                signal.await();    //ç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾è¿™é‡Œ
                System.out.println(Thread.currentThread().getName() + "å¼€å§‹äº†");
                //ç­‰å¾…1~5ç§’
                Thread.sleep(ThreadLocalRandom.current().nextInt(1000, 5000));
                System.out.println(Thread.currentThread().getName() + "ç»“æŸäº†");
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (BrokenBarrierException e) {
            e.printStackTrace();
        }

    };

    for (int i = 0; i < THREAD_NUM; i++) {
        new Thread(runnable).start();
    }

}
-----------------------------
è¾“å‡º
Thread-1ç­‰å¾…å¼€å§‹
Thread-2ç­‰å¾…å¼€å§‹
Thread-0ç­‰å¾…å¼€å§‹
======> å¼€å§‹ï¼
Thread-0å¼€å§‹äº†
Thread-2å¼€å§‹äº†
Thread-1å¼€å§‹äº†
Thread-0ç»“æŸäº†
Thread-0ç­‰å¾…å¼€å§‹
Thread-2ç»“æŸäº†
Thread-2ç­‰å¾…å¼€å§‹
Thread-1ç»“æŸäº†
Thread-1ç­‰å¾…å¼€å§‹
======> å¼€å§‹ï¼
Thread-1å¼€å§‹äº†
Thread-0å¼€å§‹äº†
Thread-2å¼€å§‹äº†
Thread-1ç»“æŸäº†
Thread-2ç»“æŸäº†
Thread-0ç»“æŸäº†
```

å¯è§å¼€å§‹äºŒå‘¨ç›®çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½è¿è¡Œåˆ°äº†ä¸´ç•Œç‚¹ï¼ˆ`signal.await()`ï¼‰åï¼Œæ‰ç»§ç»­æ‰§è¡Œçš„ã€‚

# CountDownLatchä¸CyclicBarrierçš„æ¯”è¾ƒ

CountDownLatchä¸CyclicBarrieréƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥ç†è§£æˆç»´æŠ¤çš„å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä½†æ˜¯è¿™ä¸¤è€…è¿˜æ˜¯å„æœ‰ä¸åŒä¾§é‡ç‚¹çš„ï¼š

1. CountDownLatchä¸€èˆ¬ç”¨äºæŸä¸ªçº¿ç¨‹Aç­‰å¾…è‹¥å¹²ä¸ªå…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œå®ƒæ‰æ‰§è¡Œï¼›è€ŒCyclicBarrierä¸€èˆ¬ç”¨äºä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼›CountDownLatchå¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrieræ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›ã€‚
2. è°ƒç”¨CountDownLatchçš„countDownæ–¹æ³•åï¼Œå½“å‰çº¿ç¨‹å¹¶ä¸ä¼šé˜»å¡ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›è€Œè°ƒç”¨CyclicBarrierçš„awaitæ–¹æ³•ï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°CyclicBarrieræŒ‡å®šçš„çº¿ç¨‹å…¨éƒ¨éƒ½åˆ°è¾¾äº†æŒ‡å®šç‚¹çš„æ—¶å€™ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›
3. CountDownLatchæ–¹æ³•æ¯”è¾ƒå°‘ï¼Œæ“ä½œæ¯”è¾ƒç®€å•ï¼Œè€ŒCyclicBarrieræä¾›çš„æ–¹æ³•æ›´å¤šï¼Œæ¯”å¦‚èƒ½å¤Ÿé€šè¿‡getNumberWaiting()ï¼ŒisBroken()è¿™äº›æ–¹æ³•è·å–å½“å‰å¤šä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼Œ**å¹¶ä¸”CyclicBarrierçš„æ„é€ æ–¹æ³•å¯ä»¥ä¼ å…¥barrierAction**ï¼ŒæŒ‡å®šå½“æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾æ—¶æ‰§è¡Œçš„ä¸šåŠ¡åŠŸèƒ½ï¼›
4. CountDownLatchæ˜¯ä¸èƒ½å¤ç”¨çš„ï¼Œè€ŒCyclicLatchæ˜¯å¯ä»¥å¤ç”¨çš„ã€‚

# Reference

[å¤§ç™½è¯è¯´javaå¹¶å‘å·¥å…·ç±»-Semaphoreï¼ŒExchanger](https://github.com/CL0610/Java-concurrency/commit/1bdc9296289d92a33510a8edb75fc9d051cb9c48)

[å¤§ç™½è¯è¯´javaå¹¶å‘å·¥å…·ç±»-CountDownLatchï¼ŒCyclicBarrier](https://github.com/CL0610/Java-concurrency/blob/master/25.%E5%A4%A7%E7%99%BD%E8%AF%9D%E8%AF%B4java%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB-CountDownLatch%EF%BC%8CCyclicBarrier/%E5%A4%A7%E7%99%BD%E8%AF%9D%E8%AF%B4java%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB-CountDownLatch%EF%BC%8CCyclicBarrier.md)



